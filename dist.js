"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=exports.OokConfig=void 0;var _isPropValid=_interopRequireDefault(require("@emotion/is-prop-valid"));var _react=_interopRequireDefault(require("react"));var _knownCssProperties=_interopRequireDefault(require("known-css-properties"));var _styledComponents=_interopRequireDefault(require("styled-components"));var _mqpacker=_interopRequireDefault(require("mqpacker"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var kebabCase=require("lodash/kebabCase");var postcss=require("postcss");// Ook! Ook! üçå
var OokContext=_react["default"].createContext();OokContext.displayName="Ook";var OokConfig=function OokConfig(_ref){var _ref$breakpoints=_ref.breakpoints,breakpoints=_ref$breakpoints===void 0?{}:_ref$breakpoints,children=_ref.children;return _react["default"].createElement(OokContext.Provider,{value:{breakpoints:breakpoints}},_react["default"].createElement(OokContext.Consumer,null,function(ctx){return children}))};exports.OokConfig=OokConfig;var states=["active","hover","focus","visited"];var Ook=function Ook(props){var _OokContext$,_OokContext$Consumer,_OokContext$Consumer$;var children=props.children;var breakpoints=OokContext["1"]?(_OokContext$=OokContext["1"])===null||_OokContext$===void 0?void 0:_OokContext$.breakpoints:(OokContext===null||OokContext===void 0?void 0:(_OokContext$Consumer=OokContext.Consumer)===null||_OokContext$Consumer===void 0?void 0:(_OokContext$Consumer$=_OokContext$Consumer._currentValue)===null||_OokContext$Consumer$===void 0?void 0:_OokContext$Consumer$.breakpoints)?OokContext.Consumer._currentValue.breakpoints:{};var sortedBpNamesBySize=Object.keys(breakpoints).sort(function(a,b){return parseInt(breakpoints[a],10)-parseInt(breakpoints[b],10)});var modifiedProps=Object.assign({},props);var cssProps=Object.entries(props).reduce(function(acc,_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],val=_ref3[1];if(key==="children")return acc;var prefixed=false;if(key.match(/^_/)){prefixed=true}var keb=prefixed?"-".concat(kebabCase(key)):kebabCase(key);// Pseudo classes
if(states.includes(key)||key==="after"||key==="before"){Object.entries(val).forEach(function(_ref4){var _ref5=_slicedToArray(_ref4,2),cssProp=_ref5[0],_v=_ref5[1];if(cssProp==="content"&&!_v.trim()){_v="''"}var _key=key==="after"||key==="before"?"&::".concat(key):"&:".concat(key);var keb=prefixed?"-".concat(kebabCase(cssProp)):kebabCase(cssProp);if(_knownCssProperties["default"].all.includes(keb)){// TODO: A bunch of this is duplicated below. Should probably be combined into a function.
if(_typeof(_v)==="object"){Object.entries(_v).forEach(function(_ref6){var _ref7=_slicedToArray(_ref6,2),bp=_ref7[0],v=_ref7[1];if(bp===sortedBpNamesBySize[0]){acc+="".concat(_key," { ").concat(keb,": ").concat(v,"; }")}else{acc+="@media (min-width: ".concat(breakpoints[bp],") { ").concat(_key," { ").concat(keb,": ").concat(v,"; } }")}})}if(typeof _v==="string"){acc+="".concat(_key," { ").concat(keb,": ").concat(_v,"; }")}}})}// Generic css and media queries
if(_knownCssProperties["default"].all.includes(keb)){if(_typeof(val)==="object"){// Overwrite global breakpoint rules
Object.entries(val).forEach(function(_ref8){var _ref9=_slicedToArray(_ref8,2),bp=_ref9[0],v=_ref9[1];if(bp===sortedBpNamesBySize[0]){acc+="".concat(keb,": ").concat(v,";")}else{acc+="@media (min-width: ".concat(breakpoints[bp],") { ").concat(keb,": ").concat(v,"; }")}})}if(typeof val==="string"){acc+="".concat(keb,": ").concat(val,";")}}// Some of these props (e.g. backgroundColor) cause React to throw a warning. This removes them from the ook.
if(!(0,_isPropValid["default"])(key)){delete modifiedProps[key]}return acc},"");var S=_styledComponents["default"].div.withConfig({displayName:"ook__S",componentId:"sc-1hrrez1-0"})(["",""],_mqpacker["default"].pack(cssProps).css);return _react["default"].createElement(S,null,children)};var _default=Ook;exports["default"]=_default;
